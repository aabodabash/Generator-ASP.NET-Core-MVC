// ------------------------------------------------------------------------------
// <auto-generated>
//     Ce code a été généré par un outil.
//     Version du runtime : 16.0.0.0
//  
//     Les changements apportés à ce fichier peuvent provoquer un comportement incorrect et seront perdues si
//     le code est régénéré.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Mobioos.Generators.AspNetCore
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using Mobioos.Foundation.Jade.Models;
    using Mobioos.Scaffold.BaseGenerators.TextTemplating;
    using Common.Generator.Framework.Extensions;
    using Mobioos.Generators.AspNetCore;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "16.0.0.0")]
    public partial class ViewModelTemplate : TemplateBase
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            
            #line 2 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    var model = (EntityInfo)Model;
    var lastType = ModelPropertiesTypes.LastOrDefault();

    var keyProperty = model
        .GetProperties()
        .FirstOrDefault(p => p.IsKey);

    var keyType = keyProperty != null ?
        keyProperty
            .ModelProperty?
            .Substring(
                0,
                keyProperty.ModelProperty.IndexOf(".")) :
        "";

    if (string.IsNullOrEmpty(keyType))
    {
        keyType = model
            .GetEntityDirectReferences()
            .FirstOrDefault()?
            .Id
            .CSharpType();
    }

    var datamodelsNamespace = $"{ApplicationId}.Backend.DataModels";

            
            #line default
            #line hidden
            this.Write("using System;\r\nusing System.Collections.Generic;\r\nusing System.ComponentModel.Dat" +
                    "aAnnotations;\r\nusing ");
            
            #line 32 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(datamodelsNamespace));
            
            #line default
            #line hidden
            this.Write(";\r\n\r\nnamespace ");
            
            #line 34 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ApplicationId));
            
            #line default
            #line hidden
            this.Write(".Backend.");
            
            #line 34 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ViewModelNamespace));
            
            #line default
            #line hidden
            this.Write("\r\n{\r\n    public partial class ");
            
            #line 36 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(model.Id.ToPascalCase()));
            
            #line default
            #line hidden
            
            #line 36 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(model.BaseEntity != null ? $" : {model.BaseEntity.Id.ToPascalCase()}" : ""));
            
            #line default
            #line hidden
            this.Write("\r\n    {\r\n        public ");
            
            #line 38 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(model.Id.ToPascalCase()));
            
            #line default
            #line hidden
            this.Write("() ");
            
            #line 38 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(model.BaseEntity != null ? " : base()" : ""));
            
            #line default
            #line hidden
            this.Write("\r\n        {\r\n");
            
            #line 40 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    if (model.References != null
        && model.References.Count() > 0)
    {
        foreach (var reference in model.References)
        {
            var currentReference = reference.Id;
            var referenceName = currentReference.ToPascalCase();
            var type = $"{datamodelsNamespace}.{reference.Type}";

            if (reference.IsCollection)
            {

            
            #line default
            #line hidden
            this.Write("            ");
            
            #line 53 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(referenceName));
            
            #line default
            #line hidden
            this.Write(" = new HashSet<");
            
            #line 53 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write(">();\r\n");
            
            #line 54 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
            else
            {

            
            #line default
            #line hidden
            this.Write("            ");
            
            #line 59 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(referenceName));
            
            #line default
            #line hidden
            this.Write(" = new ");
            
            #line 59 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write("();\r\n");
            
            #line 60 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
        }
    }

            
            #line default
            #line hidden
            this.Write("        }\r\n");
            
            #line 66 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    if (model.Properties != null)
    {
        foreach (var prop in model.Properties)
        {
            var propertyId = prop.Id.ToPascalCase();

            
            #line default
            #line hidden
            this.Write("\r\n        public ");
            
            #line 74 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(prop.CSharpType()));
            
            #line default
            #line hidden
            
            #line 74 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(prop.IsNullable? "?" : ""));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 74 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(propertyId));
            
            #line default
            #line hidden
            this.Write(" { get; set; }\r\n");
            
            #line 75 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        }
    }

    if (model.References !=null
        && model.References.Count() > 0)
    {
        foreach (var reference in model.References)
        {
            var currentReference = reference.Id;
            var referenceName = currentReference.ToPascalCase();
            var type = $"{datamodelsNamespace}.{reference.Type}";
            var fieldName = reference.Id.ToCamelCase();

            if (reference.IsCollection)
            {

            
            #line default
            #line hidden
            this.Write("\r\n        private HashSet<");
            
            #line 93 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write("> _");
            
            #line 93 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(";\r\n\r\n        private HashSet<");
            
            #line 95 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write("> ");
            
            #line 95 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(referenceName));
            
            #line default
            #line hidden
            this.Write("\r\n        {\r\n            get\r\n            {\r\n                return _");
            
            #line 99 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(" ??\r\n                    (_");
            
            #line 100 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(" = new HashSet<");
            
            #line 100 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write(">());\r\n            }\r\n            set\r\n            {\r\n                _");
            
            #line 104 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(" = value;\r\n            }\r\n        }\r\n");
            
            #line 107 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
            else
            {

            
            #line default
            #line hidden
            this.Write("\r\n        private ");
            
            #line 113 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write(" _");
            
            #line 113 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(";\r\n\r\n        public virtual ");
            
            #line 115 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(reference.Type));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 115 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(referenceName));
            
            #line default
            #line hidden
            this.Write("\r\n        {\r\n            get\r\n            {\r\n                return _");
            
            #line 119 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(";\r\n            }\r\n            set\r\n            {\r\n                _");
            
            #line 123 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(" = value;\r\n            }\r\n        }\r\n");
            
            #line 126 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
        }
    }

    if (model.BaseEntity == null)
    {

            
            #line default
            #line hidden
            this.Write("\r\n        [Timestamp]\r\n        public byte[] RawVersion { get; set; }\r\n");
            
            #line 137 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    }

    var isReferencedTypes = ModelPropertiesTypes.Count > 0;

            
            #line default
            #line hidden
            this.Write("\r\n        public ");
            
            #line 143 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(model.Id.ToPascalCase()));
            
            #line default
            #line hidden
            this.Write(" ConvertFromModel(");
            
            #line 143 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(isReferencedTypes ? "" : ")"));
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 144 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    if (isReferencedTypes)
    {
        foreach (var referencedType in ModelPropertiesTypes.Keys)
        {
            var parameterName = referencedType.ToCamelCase();

            var modelReference = model
                .References
                .FirstOrDefault(r =>
                    r.Type == referencedType);

            var parameterType =
                modelReference != null
                && modelReference.IsCollection ?
                    $"HashSet<{referencedType}>" :
                    referencedType;

            parameterType = $"{datamodelsNamespace}.{parameterType}";

            
            #line default
            #line hidden
            this.Write("            ");
            
            #line 164 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(parameterType));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 164 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(parameterName));
            
            #line default
            #line hidden
            
            #line 164 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(lastType.Key != referencedType ? "," : ")"));
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 165 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        }
    }

            
            #line default
            #line hidden
            this.Write("        {\r\n");
            
            #line 170 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    if (model.GetProperties() != null)
    {
        foreach (var prop in model.GetProperties())
        {
            if (!string.IsNullOrEmpty(prop.ModelProperty))
            {
                var modelProperty = prop
                    .ModelProperty
                    .Split('.');

                var parameter = $"{modelProperty[0].ToCamelCase()}.{modelProperty[1].ToPascalCase()}";

                var property = prop.Id.ToPascalCase();

            
            #line default
            #line hidden
            this.Write("            ");
            
            #line 185 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 185 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(parameter));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 186 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
        }
    }

    foreach (var reference in model.References)
    {
        var currentReference = ModelPropertiesTypes
            .FirstOrDefault(r =>
                r.Key == reference.Type);

        var parameterName = currentReference.Key.ToCamelCase();

        var fieldName = reference.Id.ToCamelCase();

            
            #line default
            #line hidden
            this.Write("            _");
            
            #line 201 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 201 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(parameterName));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 202 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    }

            
            #line default
            #line hidden
            this.Write("\r\n            return this;\r\n        }\r\n\r\n");
            
            #line 209 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    if (ModelPropertiesTypes != null)
    {
        foreach (var refType in ModelPropertiesTypes)
        {
            var currentReferenceType = model
                .References
                .FirstOrDefault(r =>
                    r.Type == refType.Key);

            var type =
                currentReferenceType != null
                && currentReferenceType.IsCollection ?
                    $"HashSet<{refType.Key}>" :
                    refType.Key;

            type = $"{datamodelsNamespace}.{type}";

            
            #line default
            #line hidden
            this.Write("        public ");
            
            #line 227 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write(" Get");
            
            #line 227 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(refType.Key));
            
            #line default
            #line hidden
            this.Write("FromViewModel()\r\n        {\r\n");
            
            #line 229 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            if (model.References?.FirstOrDefault(r => r.Type == refType.Key) != null)
            {
                var fieldName = refType.Key.ToCamelCase();

            
            #line default
            #line hidden
            this.Write("            return this._");
            
            #line 234 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 235 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }
            else
            {

            
            #line default
            #line hidden
            this.Write("            var model = new ");
            
            #line 240 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write("();\r\n");
            
            #line 241 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

                foreach (var prop in model.GetProperties())
                {
                    if (!string.IsNullOrEmpty(prop.ModelProperty)
                        && prop.ModelProperty.StartsWith($"{refType.Key}."))
                    {
                        var propertyName = prop
                            .ModelProperty?
                            .Split('.')
                            .Last()
                            .ToPascalCase();

                        var property = prop.Id.ToPascalCase();

            
            #line default
            #line hidden
            this.Write("            model.");
            
            #line 255 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 255 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 256 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

                    }
                }

            
            #line default
            #line hidden
            this.Write("\r\n            return model;\r\n");
            
            #line 262 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            }

            
            #line default
            #line hidden
            this.Write("        }\r\n");
            
            #line 266 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        }
    }

    if (!string.IsNullOrEmpty(keyType))
    {
        var currentReferenceType = model
            .References
            .FirstOrDefault(r =>
                r.Type == keyType);

        var type =
            currentReferenceType != null
            && currentReferenceType.IsCollection ?
                $"HashSet<{keyType}>" :
                keyType;

            
            #line default
            #line hidden
            this.Write("        public ");
            
            #line 283 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(type));
            
            #line default
            #line hidden
            this.Write(" ConvertToModel()\r\n        {\r\n");
            
            #line 285 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        var currentReference = model
            .References?
            .FirstOrDefault(r =>
                r.Type == keyType);

        if (currentReference != null
            && !string.IsNullOrEmpty(currentReference.Id))
        {
            var referenceName = currentReference.Id.ToPascalCase();

            
            #line default
            #line hidden
            this.Write("            return this.");
            
            #line 296 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(referenceName));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 297 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        }
        else
        {

            
            #line default
            #line hidden
            this.Write("            var model = new ");
            
            #line 302 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(keyType));
            
            #line default
            #line hidden
            this.Write("();\r\n");
            
            #line 303 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

            if (model.Properties != null)
            {
                foreach (var prop in model.Properties)
                {
                    if (!string.IsNullOrEmpty(prop.ModelProperty))
                    {
                        var modelType =  prop
                            .ModelProperty
                            .Substring(
                                0,
                                prop.ModelProperty.IndexOf("."));

                        if (modelType == keyType)
                        {
                            var propertyName = prop
                                .ModelProperty
                                .Substring(
                                    prop.ModelProperty.IndexOf(".") + 1)
                                .ToPascalCase();

            
            #line default
            #line hidden
            this.Write("            model.");
            
            #line 324 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 324 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(prop.Id.ToPascalCase()));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 325 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

                        }
                    }
                }
            }

            
            #line default
            #line hidden
            this.Write("            return model;\r\n");
            
            #line 332 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

        }

            
            #line default
            #line hidden
            this.Write("        }\r\n");
            
            #line 336 "C:\Users\PC\Documents\Gits\ASP.NET-Core-MVC\src\Mobioos.Generators.AspNetCore\Data\Templates\ViewModelTemplate.tt"

    }

            
            #line default
            #line hidden
            this.Write("    }\r\n}");
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}
